{% extends "base.html" %}
{% load lang %}

{% block title %}
Play | {% t request recitation.surah "name" %} | Islamic Web
{% endblock %}

{% block content %}
<div class="container">

  <div class="page-header">
    <h1 class="page-title">Now Playing</h1>
    <p class="page-subtitle">
      {{ recitation.surah.number }} - {% t request recitation.surah "name" %}
      ‚Äî {% t request recitation.reciter "name" %}
    </p>
  </div>

  <div class="section">
    <div class="cards">
      <div class="card recitation-card">

        {% if recitation.surah.get_image_url %}
          <div class="card-media">
            <img src="{{ recitation.surah.get_image_url }}" alt="{% t request recitation.surah 'name' %}">
            <div class="play-overlay">
              <button
                type="button"
                class="btn btn-primary play-btn"
                data-play-one
                data-audio="{{ recitation.audio_file.url }}"
                data-title="{{ recitation.surah.number }} - {% t request recitation.surah 'name' %} ‚Äî {% t request recitation.reciter 'name' %} ({{ recitation.recitation_type }})"
                aria-label="Play recitation">
                ‚ñ∂
              </button>
            </div>
          </div>
        {% endif %}

        <div class="card-body">

          <div class="card-header">
            <h3 class="card-title">
              {{ recitation.surah.number }} - {% t request recitation.surah "name" %}
            </h3>

            <p class="card-subtitle">
              <span aria-hidden="true">üë§</span> {% t request recitation.reciter "name" %}
            </p>

            <div class="card-meta">
              <span class="badge badge-type">{{ recitation.recitation_type|title }}</span>

              {% if recitation.surah.juz.all %}
                <span class="badge badge-juz">
                  {% for juz in recitation.surah.juz.all %}
                    Juz {{ juz.number }}{% if not forloop.last %}, {% endif %}
                  {% endfor %}
                </span>
              {% endif %}
            </div>
          </div>

          <div class="card-actions">

            <button
              type="button"
              class="btn btn-primary"
              data-play-one
              data-audio="{{ recitation.audio_file.url }}"
              data-title="{{ recitation.surah.number }} - {% t request recitation.surah 'name' %} ‚Äî {% t request recitation.reciter 'name' %} ({{ recitation.recitation_type }})">
              ‚ñ∂ Play
            </button>

            <a href="{% url 'surah_detail' recitation.surah.id %}" class="btn btn-secondary">
              Surah
            </a>

            <form method="post" class="inline-form">
              {% csrf_token %}
              <button
                type="submit"
                name="action"
                value="favorite"
                class="btn btn-outline btn-favorite"
                {% if is_favorite %}disabled aria-disabled="true"{% endif %}
                title="{% if is_favorite %}Already in favorites{% else %}Add to favorites{% endif %}">
                {% if is_favorite %}‚ù§Ô∏è{% else %}‚ô°{% endif %}
              </button>
            </form>

            <form method="post" class="inline-form">
              {% csrf_token %}
              <input type="hidden" name="action" value="add_to_playlist">

              <label class="sr-only" for="pl_add_{{ recitation.id }}">Playlist</label>
              <select id="pl_add_{{ recitation.id }}" name="playlist_id" required class="select-sm">
                <option value="">Playlist</option>
                {% for p in playlists %}
                  <option value="{{ p.id }}">{% t request p "name" %}</option>
                {% endfor %}
              </select>

              <button type="submit" class="btn btn-success btn-sm" title="Add to playlist" aria-label="Add to playlist">
                +
              </button>
            </form>

          </div>

        </div>
      </div>
    </div>

    <div style="margin-top:16px;">
      <a href="{% url 'surah_detail' recitation.surah.id %}" class="btn btn-outline btn-sm">
        ‚Üê Back to Surah
      </a>
    </div>

  </div>
</div>
{% endblock %}
